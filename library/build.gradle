apply plugin: "com.android.library"
apply plugin: "kotlin-android"
apply plugin: 'org.jetbrains.dokka-android'

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.dcendents:android-maven-gradle-plugin:2.1'
        classpath 'com.jfrog.bintray.gradle:gradle-bintray-plugin:1.8.4'
        classpath "org.jetbrains.dokka:dokka-android-gradle-plugin:0.9.17"
    }
}

ext {
    bintrayRepo = 'github'
    bintrayName = 'libgdx-oboe'

    publishedGroupId = 'com.github.barsoosayque'
    libraryName = 'libGDX Oboe'
    artifact = 'libgdxoboe'

    libraryDescription = 'libGDX audio replacement for Android (API 16+) built on top of Oboe.'

    siteUrl = 'https://github.com/barsoosayque/libgdx-oboe'
    gitUrl = 'https://github.com/barsoosayque/libgdx-oboe.git'

    libraryVersion = '0.2.3'

    developerId = 'barsoosayque'
    developerName = 'barsoosayque'
    developerEmail = 'shtoshich@gmail.com'

    licenseName = 'The MIT License'
    licenseUrl = 'https://opensource.org/licenses/MIT'
    allLicenses = ["MIT"]
}

configurations { natives }
sourceCompatibility = 1.6

dependencies {
    implementation "com.badlogicgames.gdx:gdx-backend-android:$gdxVersion"
    implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlinVersion"
}

android {
    buildToolsVersion "29.0.2"
    compileSdkVersion 29
    sourceSets.main {
        manifest.srcFile 'AndroidManifest.xml'
        java.srcDirs = ['src/kotlin']
        jni.srcDirs = ['src/cpp']
        jniLibs.srcDirs= [ 'libs' ]
    }
    packagingOptions {
        exclude 'lib/armeabi-v7a/*.so'
        exclude 'lib/arm64-v8a/*.so'
        exclude 'lib/x86/*.so'
        exclude 'lib/x86_64/*.so'
    }
    defaultConfig {
        minSdkVersion 16
        targetSdkVersion 29
        ndk { abiFilters 'x86', 'x86_64', 'armeabi-v7a', 'arm64-v8a' }
        externalNativeBuild {
            cmake {
                cppFlags "-std=c++17 -O3 -DCMAKE_BUILD_TYPE=Release -DNDEBUG"
            }
        }
        consumerProguardFiles 'proguard-rules.pro'
    }
    externalNativeBuild {
        cmake {
            path "CMakeLists.txt"
        }
    }
}

dokka {
    outputFormat = 'html'
    outputDirectory = "$buildDir/javadoc"
}

apply from: 'install.gradle'
apply from: 'bintray.gradle'